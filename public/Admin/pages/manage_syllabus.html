<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<head>
	<meta charset="utf-8" />
	<title>Syllabus Manager</title>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	
	<!-- ================== BEGIN BASE CSS STYLE ================== -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
	<link href="../../assets/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet" />
	<link href="../../assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

	<link href="../../assets/plugins/animate/animate.min.css" rel="stylesheet" />
	<link href="../../assets/css/default/style.min.css" rel="stylesheet" />
	<link href="../../assets/css/default/style-responsive.min.css" rel="stylesheet" />
	<link href="../../assets/css/default/theme/default.css" rel="stylesheet" />
	<!-- ================== END BASE CSS STYLE ================== -->
	<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<!-- ================== BEGIN BASE JS ================== -->
	<script src="../../assets/plugins/pace/pace.min.js"></script>
	<!-- ================== END BASE JS ================== -->
</head>
<style>
.card-header{
    height:50px;
}
.topic-area {
	background-color:#eccc68;

}
.chapter-area {
    background-color:#70a1ff;
    color:white;   
    height:wrap
}
.subject-area{
	background: #dfe4ea;
	height: wrap;
}
.add-button{
    font-size:1.5em;
    height:50px;
	margin:10px;
}
.delete-button {
    color:red;
    float:right;
}
.card-header:hover{
    cursor:pointer
}
.domain_title{
    margin-top: 2px;
    font-weight: 1em;
}
.accordion-chapter{
	margin-bottom:5px;
	padding-bottom:0;
}
</style>
<body>
	<script>
	

	</script>
	<!-- begin #page-loader -->
	<div id="page-loader" class="fade show"><span class="spinner"></span></div>
	<!-- end #page-loader -->
	
	<!-- begin #page-container -->
	<div id="page-container" class="fade page-sidebar-fixed page-header-fixed">
		<!-- begin #header -->
		<div id="header" class="header navbar-default">
			<!-- begin navbar-header -->
			<div class="navbar-header">
				<a  class="navbar-brand"><span ></span> <b>PE</b> Tests Admin.</a>
				<button type="button" class="navbar-toggle" data-click="sidebar-toggled">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
			</div>
			<!-- end navbar-header -->
			
			<!-- begin header-nav -->
			<ul class="navbar-nav navbar-right">
				<li>
					<form class="navbar-form">
						<div class="form-group">
							<input type="text" class="form-control" placeholder="Enter keyword" />
							<button type="submit" class="btn btn-search"><i class="fa fa-search"></i></button>
						</div>
					</form>
				</li>
				
				<li class="dropdown navbar-user">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown">
						<div class="image image-icon bg-black text-grey-darker">
						<img src="../PE_Resources/paathshala_logo_512.png">
						</div>
						<span id="navbarNameHolder"></span>
					</a>
					<div class="dropdown-menu dropdown-menu-right">
						<a href="#" id="logoutButton" class="dropdown-item" style="cursor: pointer;" >Log Out</a>
					</div>
				</li>
			</ul>
			<!-- end header navigation right -->
		</div>
		<!-- end #header -->
		
		<!-- begin #sidebar -->
		<div id="sidebar" class="sidebar">
			<!-- begin sidebar scrollbar -->
			<div data-scrollbar="true" data-height="100%">
				<!-- begin sidebar user -->
				<ul class="nav">
					<li class="nav-profile">
						<a href="javascript:;" data-toggle="nav-profile">
							<div class="cover with-shadow"></div>
							<div class="info">
								<p id="sidebarNameHolder"></p>
								<small>PE Admin</small>
							</div>
						</a>
					</li>

				
				</ul>
				<!-- end sidebar user -->
				<!-- begin sidebar nav -->
				<ul class="nav">
					<li class="nav-header">Navigation</li>
					<li>
						<a href="./dashboard.html">
							<i class="fa fa-th-large"></i>
							<span>Home</span>
						</a>
					</li>
					<li class="has-sub">
						<a href="javascript:;">
							<i class="fa fa-user" aria-hidden="true"></i>
							<span>Admin Settings</span>
						</a>
						<ul class="sub-menu">
							<li><a href="./create_admin.html">Create Admins</a></li>
							<li><a href="./manage_admins.html">Manage Admins</a></li>
						</ul>
					</li>
					<li class="has-sub">
						<a href="javascript:;">
							<i class="fa fa-graduation-cap" aria-hidden="true"></i>
							<span>Student Settings</span>
						</a>
						<ul class="sub-menu">
							<li><a href="./register_student.html">Register Student</a></li>
							<li><a href="./manage_students.html">Manage Students</a></li>
						</ul>
					</li>
					<li class="active">
						<a href="./manage_syllabus.html">
							<i class="fa fa-book" aria-hidden="true"></i>
							<span>Syllabus Manager</span>
						</a>
					</li>
					<li class="has-sub">
						<a href="javascript:;">
							<i class="fa fa-plus-circle" aria-hidden="true"></i>
							<span>Create NEET Tests</span>
						</a>
						<ul class="sub-menu">
							<li><a href="./create_neet_fst.html"> FST Test</a></li>
							<li><a href="./create_neet_cwt.html"> CWT Test</a></li>
							<li><a href="./create_neet_swt.html"> SWT Test</a></li>
						</ul>
					</li>
					<li class="has-sub">
						<a href="javascript:;">
						<i class="fa fa-pencil" aria-hidden="true"></i>
						<span> Modify Tests </span>
						</a>
						<ul class="sub-menu">
							<li><a href="./modify_fst.html">Modify FST Tests</a></li>
							<li><a href="./modify_cwt.html">Modify CWT Tests</a></li>
							<li><a href="./modify_swt.html">Modify SWT Tests</a></li>
						</ul>
					</li>
					<!-- menu 2-->
					<!-- begin sidebar minify button -->
					<li><a href="javascript:;" class="sidebar-minify-btn" data-click="sidebar-minify"><i class="fa fa-angle-double-left"></i></a></li>
					<!-- end sidebar minify button -->
				</ul>
				<!-- end sidebar nav -->
			</div>
			<!-- end sidebar scrollbar -->
		</div>
		<div class="sidebar-bg"></div>
		<!-- end #sidebar -->
		
		<!-- begin #content -->
		<div id="content" class="content">
			<!-- begin breadcrumb -->
			<ol class="breadcrumb pull-right">
				<li class="breadcrumb-item active"><a href="#">Syllabus Manager</a></li>
			</ol>
			<!-- end breadcrumb -->
			<!-- begin page-header -->
			<h1 class="page-header">Syllabus Manager</h1>
			<!-- end page-header -->
			
			<!-- begin panel -->
			<div class="panel panel-inverse">
				<div class="panel-heading">
					<div class="panel-heading-btn">
					</div>
					<h4 class="panel-title">SYLLABUS </h4>
				</div>
				<div class="panel-body">
					<div id="domain_panel">
                    </div>
                    <button class="btn btn-green add-button" onclick="addDomain()" style="width:100%"> <i class="fa fa-plus-circle" aria-hidden="true"></i> Create New Domain</button>
				</div>
			</div>
			<!-- end panel -->
		</div>
		<!-- end #content -->
		
		<!-- begin scroll to top btn -->
		<a href="javascript:;" class="btn btn-icon btn-circle btn-success btn-scroll-to-top fade" data-click="scroll-top"><i class="fa fa-angle-up"></i></a>
		<!-- end scroll to top btn -->
	</div>
	<!-- end page container -->
	
	<!-- ================== BEGIN BASE JS ================== -->
	<script src="../../assets/plugins/jquery/jquery-3.3.1.min.js"></script>
	<script src="../../assets/plugins/jquery-ui/jquery-ui.min.js"></script>
	<script src="../../assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
	<!--[if lt IE 9]>
		<script src="../../assets/crossbrowserjs/html5shiv.js"></script>
		<script src="../../assets/crossbrowserjs/respond.min.js"></script>
		<script src="../../../admin/template../../assets/crossbrowserjs/excanvas.min.js"></script>
	<![endif]-->
	<script src="../../assets/plugins/slimscroll/jquery.slimscroll.min.js"></script>
	<script src="../../assets/plugins/js-cookie/js.cookie.js"></script>
	<script src="../../../admin/template../../assets/js/theme/default.min.js"></script>
	<script src="../../assets/js/apps.min.js"></script>
	<!-- ================== END BASE JS ================== -->
	
	<script>
	var pe_username;
	var pe_email;
	var domain_url = "https://photonecademy.com/tests";
	var user_access_token = localStorage.getItem("admin_token");
    // Get Entire Syllabus

	// All Nameplace holders

		// Sidebar Name Holder
		var sidebarNameHolder = document.getElementById("sidebarNameHolder");
		// Logout functionality
		var logout = document.getElementById("logoutButton");
		logout.addEventListener("click",()=>{
			localStorage.clear();
			document.location.href=`${domain_url}/admin`;

		})
		//Navbar name holder
		var navNameHolder = document.getElementById("navbarNameHolder");
	console.log("access token:-"+user_access_token)
		if(user_access_token==null)
		{
			document.location.href=`${domain_url}/admin`;

		}

		fetch(`${domain_url}/verifyAdmin`,{
			headers:{
				method:"GET",
				authorization:user_access_token
			}
		}).then(response=>response.json()).then(data=>{
			console.log("is token verified? "+data.is_verified);
			if(data.is_verified==false)
			{
				document.location.href=`${domain_url}/admin`;
			}
			if(data.is_verified==true)
			{

				console.log(data.admin);
				pe_username = data.admin.adminID;
				console.log("The Logged in user is :"+pe_username);
				sidebarNameHolder.innerHTML=pe_username;
                navNameHolder.innerHTML=pe_username;
                
                console.log("%c Fetching Syllabus...","color:blue;font-weight:bold")
                // Get Full Syllabus
                fetch(`${domain_url}/getFullSyllabus`,{
                    method:"GET",
                    headers:{
                        authorization:user_access_token
                    }
                }).then(response => response.json()).then(syllabusData=>{
                    if(syllabusData.is_successful)
                    {
                        var dp = document.getElementById("domain_panel")

                        console.log("%c Syllabus Fetched ","color:green;font-weight:bold")
                        console.log(syllabusData)
                        syllabusData.syllabus.forEach(domain=>{
							var unique_id= domain.name.replace(/[ ,.()&':;[[\]]/g,"");
                            dp.innerHTML+=` 
                            <div class="accordion" id="accordion${unique_id}">
                           
                           <div class="card" id="card${unique_id}">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
                                            <i class="fa fa-globe" style="font-size:1.3em;text-align:middle" aria-hidden="true"></i>&nbsp ${domain.name}
                                            <i class="fa fa-minus-square delete-button" onclick="deleteDomain('${domain.name}')" aria-hidden="true"></i>

                                    </p>
                                    </h4>
                                </div>
                                <div id="${unique_id}Collapse" class="collapse" aria-labelledby="${unique_id}Heading" data-parent="#accordion${unique_id}">
                                    <div class="card-body chapter-area">
                                    <div id="${unique_id}SubjectsArea">

                                    </div>
                                   <button class="btn btn-green add-button" onclick="addSubject('${domain._id}','${domain.name}')" style="width:100%"> <i class="fa fa-book" aria-hidden="true"></i> Add Subject</button>
                                    </div>
                                </div>
                            </div>`
                            // If Domain Has Subjects
                            if(domain.Subjects!=null)
                            {
								// Load Each Subjects
                                var subjectpanel = document.getElementById(`${domain.name}SubjectsArea`)
                                domain.Subjects.forEach(subject=>{
									var unique_id = `${domain.name}${subject.name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
                                    subjectpanel.innerHTML+=` 
                            <div class="accordion" id="accordion${unique_id}">
                           
                           <div class="card">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
										<i class="fa fa-book" aria-hidden="true"></i></i>&nbsp ${subject.name}
										<i class="fa fa-minus-square delete-button" onclick="deleteSubject('${domain.name}','${subject.name}')" aria-hidden="true"></i>

                                    </p>
                                    </h4>
                                </div>
                                <div id="${unique_id}Collapse" class="collapse" aria-labelledby="${unique_id}Heading" data-parent="#accordion${unique_id}">
									<div class="card-body subject-area" id="${unique_id}ChaptersArea">
										<h4>CHAPTERS</h4>
									</div>
									<button class="btn btn-green add-button" onclick="addChapter('${domain.name}','${subject.name}')" style="width:100%"> 
									<i class="fa fa-file-text" aria-hidden="true"></i> Add Chapter</button>
									<div class="card-body subject-area" id="${unique_id}SectionsArea">
										<h4>SECTIONS</h4>
									</div>
									<button class="btn btn-green add-button" onclick="addSection('${domain.name}','${subject.name}')" style="width:100%"> 
									
										<i class="fa fa-info-circle" aria-hidden="true"></i> Add Section</button>
								</div>
							</div>`
							// Load Each Chapters
							if(subject.Chapters!=null)
							{
								var unique_chapter_area_id = `${domain.name}${subject.name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
								var chapters_panel = document.getElementById(`${unique_chapter_area_id}ChaptersArea`);
								subject.Chapters.forEach(chapter=>{
									var unique_id=`${domain.name}${subject.name}${chapter.name}`.replace(/[ ,.()?\&|':;\[\]]/g,"")
									chapters_panel.innerHTML+=`
									<div class="accordion" id="accordion${unique_id}">
                           
                           <div class="card  accordion-chapter">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
										<i class="fa fa-file" aria-hidden="true"></i>&nbsp ${chapter.name}
										<i class="fa fa-minus-square delete-button" onclick="deleteChapter('${domain.name}','${subject.name}','${chapter.name}')" aria-hidden="true"></i>
                                    </p>
                                    </h4>
                                </div>
                                <div id="${unique_id}Collapse" class="collapse" aria-labelledby="${unique_id}Heading" data-parent="#accordion${unique_id}">
									<div class="card-body topic-area" id="${unique_id}TopicsArea">
									</div>
									<button class="btn btn-green add-button" onclick="addTopic('${domain.name}','${subject.name}','${chapter.name}')" style="width:100%"> <i class="fa fa-file-text" aria-hidden="true"></i> Add Topic</button>
								</div>
							</div>`
								})
							}
							if(subject.Topics!=null)
							{
								subject.Topics.forEach(topic=>{
									var unique_topic_area_id = `${domain.name}${subject.name}${topic.chapter}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
									var topics_panel = document.getElementById(`${unique_topic_area_id}TopicsArea`);
									var unique_id=`${domain.name}${subject.name}${topic.chapter}${topic.name}`.replace(/[ ,.()?\&|':;\[\]]/g,"")
									topics_panel.innerHTML+=`
									<div class="accordion" id="accordion${unique_id}">
                           
                           <div class="card  accordion-chapter">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
										<i class="fa fa-file" aria-hidden="true"></i>&nbsp ${topic.name}
										<i class="fa fa-minus-square delete-button" onclick="deleteTopic('${domain.name}','${subject.name}','${topic.chapter}','${topic.name}')" aria-hidden="true"></i>
                                    </p>
                                    </h4>
                                </div>
							</div>`
								})
							}
							// Load All Sections
							if(subject.Sections!=null)
							{
								var unique_section_area_id = `${domain.name}${subject.name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
								var sections_panel = document.getElementById(`${unique_section_area_id}SectionsArea`);
								subject.Sections.forEach(section=>{
									var unique_id=`${domain.name}${subject.name}${section.name}`.replace(/[ ,.()?\&|':;\[\]]/g,"")
									sections_panel.innerHTML+=`
									<div class="accordion" id="accordion${unique_id}">
                           
                           <div class="card  accordion-chapter">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
										<i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp ${section.name}
										<i class="fa fa-minus-square delete-button" onclick="deleteSection('${domain.name}','${subject.name}','${section.name}')" aria-hidden="true"></i>
                                    </p>
                                    </h4>
                                </div>
							</div>`
							})
						}

                                })
                            }
                           
                        })
                    }
                    else
                    {
                        console.log("%c Failed to fetch syllabus","color:red;font-weight:bold");
                    }
                })


			}
		
        })
        
        //Functions Related To Syllabus Manager

        // Create New Domain
        function addDomain(){
            var dp = document.getElementById("domain_panel")

            var domain_name = prompt("Enter Domain:");
            if(domain_name!=null)
            {
                console.log("%c Creating Domain...","color:blue;font-weight:bold")
                fetch(`${domain_url}/createDomain`,{
                    method:"POST",
                    headers:{
                        authorization:user_access_token,
                        'Content-Type':'application/json'
                    },
                    body:JSON.stringify({"domain_name":domain_name})
                }).then(response => response.json()).then(data =>{
                    if(data.is_successful)
                    {
					var unique_id = data.domain[0].name.replace(/[ ,.()?\&|':;\[\]]/g,"");
                    console.log("%c Domain Created Successfully","color:green;font-weight:bold");
                    dp.innerHTML+=`<div class="accordion" id="accordion${unique_id}">       
                           <div class="card" id="card${unique_id}">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
                                            <i class="fa fa-globe" style="font-size:1.3em;text-align:middle" aria-hidden="true"></i>&nbsp ${data.domain[0].name}<i class="fa fa-minus-square delete-button" onclick="deleteDomain('${data.domain[0].name}')" aria-hidden="true"></i>
                                    </p>
                                    </h4>
                                </div>
                                <div id="${unique_id}Collapse" class="collapse" aria-labelledby="${unique_id}Heading" data-parent="#accordion${unique_id}">
                                    <div class="card-body chapter-area">
                                    <div id="${data.domain[0].name}SubjectsArea">

                                    </div>
                                   <button class="btn btn-green add-button" onclick="addSubject('${data.domain[0]._id}','${data.domain[0].name}')" style="width:100%"> <i class="fa fa-plus-circle" aria-hidden="true"></i> Add Subject</button>
                                    </div>
                                </div>
                            </div>`
                    }
                    else
                    {
                        console.log("%c Failed to create Domain","color:red;font-weight:bold");

                    }
                })
        
            }
        }

        // deleteDomain
        function deleteDomain(domain_name)
        {
			console.log("%c Deleting Domain","color:blue;font-weight:bold")
			console.log(domain_name)
            fetch(`${domain_url}/deleteDomain`,{
                method:"POST",
                headers:{
                    authorization:user_access_token,
                    'Content-type':'application/json'
                },
                body:JSON.stringify({"domain_name":domain_name})
            }).then(response => response.json()).then(data=>{
                console.log(data)
                if(data.is_successful)
                {
					unique_id=domain_name.replace(/[ ,.()?\&|':;\[\]]/g,"")
                    document.getElementById(`card${unique_id}`).remove();
                }
                else
                {
                    console.log("%c Failed to delete domain","color:red;font-weight:bold")
                }
            })
        }


        // Add A Subject To Domain
        function addSubject(domainID,domain_name)
        {
            console.log(`domain id is ${domainID}`);
            console.log(`domain name is ${domain_name}`)
            var subject_name = prompt("Enter Subject Name");
            if(subject_name!=null)
            {
            fetch(`${domain_url}/addSubjectToDomain`,{
                method:"POST",
                headers:{
                    authorization:user_access_token,
                    'Content-type':"application/json"
                },
                body:JSON.stringify({"domain_id":domainID,"subject_name":subject_name})
            }).then(response => response.json()).then(data=>{
				if(data.is_successful)
				{
					var domain_unique = domain_name.replace(/[ ,.()?\&|':;\[\]]/g,"")
					console.log("%c Subject added successfully","color:green;font-weight:bold");
					var subjects_panel = document.getElementById(`${domain_unique}SubjectsArea`);
					console.log("This is subject Panel");
					var unique_id = `${domain_name}${data.subject}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
					console.log(subjects_panel);
					subjects_panel.innerHTML+=`
					<div class="accordion" id="accordion${unique_id}">
                           <div class="card" id="card${unique_id}">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
										<i class="fa fa-book" aria-hidden="true"></i></i>&nbsp ${data.subject}
                                            <i class="fa fa-minus-square delete-button" onclick="deleteSubject('${domain_name}','${data.subject}')" aria-hidden="true"></i>

                                    </p>
                                    </h4>
                                </div>
								<div id="${unique_id}Collapse" class="collapse" aria-labelledby="${unique_id}Heading" data-parent="#accordion${unique_id}">
									<div class="card-body subject-area" id="${unique_id}ChaptersArea">
									<h4>CHAPTERS</h4>
									</div>
									<button class="btn btn-green add-button" onclick="addChapter('${domain_name}','${data.subject}')" style="width:100%"> <i class="fa fa-file-text" aria-hidden="true"></i> Add Chapter</button>
									<div class="card-body subject-area" id="${unique_id}SectionsArea">
										<h4>SECTIONS</h4>
									</div>
									<button class="btn btn-green add-button" onclick="addSection('${domain_name}','${data.subject}')" style="width:100%"> 
									
										<i class="fa fa-info-circle" aria-hidden="true"></i> Add Section</button>
									</div>
                            </div>
					`
				}
				else
				{
					alert("Failed to add subject")
				}
            })
            }
		}
		// Delete Subject From Domain

		function deleteSubject(domain_name,subject_name)
		{
			console.log("%c Deleting Subject...","color:blue;font-wegiht:bold")
			console.log(`Domain name is ${domain_name}`);
			console.log(`Subject Name is ${subject_name}`);
			s_name = subject_name;
			d_name = domain_name;
			fetch(`${domain_url}/deleteSubjectFromDomain`,{
				method:"POST",
				headers:{
				method:"POST",
				authorization:user_access_token,
				"Content-type":"application/json"
			},
				body:JSON.stringify({"subject_name":s_name,"domain_name":d_name})
			}).then(response => response.json()).then(data =>{
				if(data.is_successful)
				{
			    var unique_id = `${domain_name}${subject_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"")
				document.getElementById(`accordion${unique_id}`).remove();
				console.log("%c Deleted Subject Successfully","color:green;font-weight:bold")
				}
				else
				{
					console.log("%c Failed to delete subject :( ","color:red;font-weight:bold")
					alert("failed to delete Subject")
				}
			})
		}

		// Add A Chapter to subject
		function addChapter(domain_name,subject_name)
		{
			console.log(`domain is ${domain_name}`);
			console.log(`subject is ${subject_name}`)
			var chapter_name = prompt("Enter Chapter Name:");
			if(chapter_name!=null)
			{
				fetch(`${domain_url}/addChapterToSubject`,{
					method:"POST",
					headers:{
						authorization:user_access_token,
						"Content-Type":"application/json"
					},
					body:JSON.stringify({"domain_name":domain_name,"subject_name":subject_name,"chapter_name":chapter_name})
				}).then(response => response.json()).then(data=>{
					if(data.is_successful)
					{
						chapters_panel_unique_id = `${domain_name}${subject_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
						chapters_panel = document.getElementById(`${chapters_panel_unique_id}ChaptersArea`);
						console.log(chapters_panel);
						var unique_id = `${domain_name}${subject_name}${chapter_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
						chapters_panel.innerHTML+=`
						<div class="accordion" id="accordion${unique_id}">
                           <div class="card accordion-chapter" id="card${unique_id}">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
										<i class="fa fa-file" aria-hidden="true"></i>&nbsp ${chapter_name}
                                            <i class="fa fa-minus-square delete-button" onclick="deleteChapter('${domain_name}','${subject_name}','${chapter_name}')" aria-hidden="true"></i>

                                    </p>
                                    </h4>
                                </div>
								<div id="${unique_id}Collapse" class="collapse" aria-labelledby="${unique_id}Heading" data-parent="#accordion${unique_id}">
									<div class="card-body topic-area" id="${unique_id}TopicsArea">
									</div>
									<button class="btn btn-green add-button" onclick="addTopic('${domain_name}','${subject_name}','${chapter_name}')" style="width:100%"> <i class="fa fa-file-text" aria-hidden="true"></i> Add Topic</button>
								</div>
                            </div>
						
						`
					}
					else
					{
						alert("Failed to add Chapter")
					}
					
				})
			}
		}

		// Delete Chapter From Subject
		function deleteChapter(domain_name,subject_name,chapter_name){
			console.log("%c Deleteing Chapter..","color:blue;font-weight:bold");
			fetch(`${domain_url}/deleteChapterFromSubject`,{
				method:"POST",
				headers:{
					authorization:user_access_token,
					'Content-type':'application/json'
				},
				body:JSON.stringify({"subject_name":subject_name,"domain_name":domain_name,"chapter_name":chapter_name})
			}).then(response=>response.json()).then(data=>{
				if(data.is_successful)
				{
					var unique_id = `accordion${domain_name}${subject_name}${chapter_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
					document.getElementById(unique_id).remove()
				}
				else
				{
					alert("Failed to delete Chapter")
				}
			})
		}

		// Add Section To Subject
		function addSection(domain_name,subject_name)
		{
			var section_name = prompt("Enter Name of Section: ");
			if(section_name!=null)
			{
				fetch(`${domain_url}/addSectionToSubject`,{
					method:"POST",
					headers:{
						authorization:user_access_token,
						'Content-type':"application/json"
					},
					body:JSON.stringify({"domain_name":domain_name,"subject_name":subject_name,"section_name":section_name})
				}).then(response=>response.json()).then(data=>{
					console.log("%c Adding Section","color:blue;font-weight:bold");
					console.log(data);
					if(data.is_successful)
					{
						console.log("%c Added Section Successfully","color:green;font-weight:bold")
						console.log(data);
						var unique_section_area_id = `${domain_name}${subject_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
						var sections_panel = document.getElementById(`${unique_section_area_id}SectionsArea`)
						var unique_id=`${domain_name}${subject_name}${section_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"")

						sections_panel.innerHTML+=`
									<div class="accordion" id="accordion${unique_id}">
                           
                           <div class="card  accordion-chapter">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
										<i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp ${section_name}
										<i class="fa fa-minus-square delete-button" onclick="deleteSection('${domain_name}','${subject_name}','${section_name}')" aria-hidden="true"></i>
                                    </p>
                                    </h4>
                                </div>
							</div>`
					}
					else
					{
						alert("Failed to add Section")
					}
				})
			} 
		} 


		// Delete Section From subject
		function deleteSection(domain_name,subject_name,section_name){
			console.log("%c Deleteing Section..","color:blue;font-weight:bold");
			fetch(`${domain_url}/deleteSectionFromSubject`,{
				method:"POST",
				headers:{
					authorization:user_access_token,
					'Content-type':'application/json'
				},
				body:JSON.stringify({"subject_name":subject_name,"domain_name":domain_name,"section_name":section_name})
			}).then(response=>response.json()).then(data=>{
				if(data.is_successful)
				{
					var unique_id = `accordion${domain_name}${subject_name}${section_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
					document.getElementById(unique_id).remove()
					console.log("%c Section Deleted Successfully","color:green;font-weight:bold")
				}
				else
				{
					alert("Failed to delete Chapter")
				}
			})
		}

		// add Topic to Chapter
		function addTopic(domain_name,subject_name,chapter_name)
		{
			var topic_name = prompt("Enter Topic Name:");
			if(topic_name!=null)
			{
				fetch(`${domain_url}/addTopicToChapter`,{
					method:"POST",
					headers:{
						authorization:user_access_token,
						'Content-type':'application/json'
					},
					body:JSON.stringify({"domain_name":domain_name,"subject_name":subject_name,"chapter_name":chapter_name,"topic_name":topic_name})
				}).then(response => response.json()).then(data=>{
					console.log("%c Adding Topic....","color:blue;font-weight:bold");
					if(data.is_successful)
					{
						console.log("%c Added Section Successfully","color:green;font-weight:bold")
						console.log(data);
						var unique_topic_area = `${domain_name}${subject_name}${chapter_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
						var topics_panel = document.getElementById(`${unique_topic_area}TopicsArea`)
						var unique_id=`${domain_name}${subject_name}${chapter_name}${topic_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"")

						var topics_panel = document.getElementById(`${unique_topic_area}TopicsArea`)
						topics_panel.innerHTML+=`
									<div class="accordion" id="accordion${unique_id}">
                           
                           <div class="card  accordion-chapter">
                                <div class="card-header bg-dark" id="${unique_id}Heading">
                                    <h4 class="domain_title">
                                    <p class="collapsed text-white" data-toggle="collapse" data-target="#${unique_id}Collapse" aria-expanded="false" aria-controls="collapseTwo">
										<i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp ${topic_name}
										<i class="fa fa-minus-square delete-button" onclick="deleteTopic('${domain_name}','${subject_name}','${chapter_name}','${topic_name}')" aria-hidden="true"></i>
                                    </p>
                                    </h4>
                                </div>
							</div>`
					}
				})
			}
		}

		// Delete Topic

		function deleteTopic(domain_name,subject_name,chapter_name,topic_name)
		{
			fetch(`${domain_url}/deleteTopicFromChapter`,{
				method:"POST",
				headers:{
					authorization:user_access_token,
					'Content-type':'application/json'
				},
				body:JSON.stringify({"domain_name":domain_name,"chapter_name":chapter_name,"topic_name":topic_name,"subject_name":subject_name})
			}).then(response => response.json()).then(data=>{
				if(data.is_successful)
				{
					var unique_id = `accordion${domain_name}${subject_name}${chapter_name}${topic_name}`.replace(/[ ,.()?\&|':;\[\]]/g,"");
					document.getElementById(unique_id).remove()
					console.log("%c Topic Deleted Successfully","color:green;font-weight:bold")
				}
				else
				{
					alert("Failed to delete topic")
				}
			})
		}
		$(document).ready(function() {
			App.init();
        });      

	</script>
</body>
</html>
